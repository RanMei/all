<!DOCTYPE html>

<html>

<head>
	<title>canvas</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<style>
	* {margin:0;padding:0}
	canvas {width:1000px;height:600px;margin:20px auto auto auto;border:5px solid green;display:block;}
	</style>
	<script>
	window.onload=function(){
		
		var $canvas = document.getElementById("mycanvas");
		var $w = 1000;
		var $h = 600; 
		var z = $canvas.getContext("2d");
		var $hue = 360;
		var $tick = 0;
		var circles = [];
		
		z.lineWidth=2;
		z.lineCap="round";
		z.lineJoin="round";
		
		function Circle( x,y ){
			this.x = x;
			this.y = y;
			this.r = Math.round(400*Math.random());
			this.alpha = 1;
			this.color = 'rgba(200,30,200,1)';
			this.tick = 0;
		};
		Circle.prototype = {
			step: function(){
				this.x+= Math.random()*6-3;
				this.y+= Math.random()*6-3;
				this.alpha = 1 - 0.008*this.tick;
				this.color = 'rgba(10,30,200,'+this.alpha+')';
				this.tick++;
				this.draw();
			},
			draw: function(){
				//console.log( this );
				
				z.beginPath();
				z.strokeStyle = this.color;
				z.arc( this.x,this.y,this.r,0,2*Math.PI );
				z.stroke();
			}
		}
		
		function render(){

			if( circles.length<500 ){
				circles.push( new Circle( $w/2,$h/2/*Math.random()*$w,Math.random()*$h*/ ) );
			};
			//z.globalCompositeOperation = 'source-over';
			z.fillStyle = 'rgba(0,0,0,0.5)';
			z.fillRect( 0,0,$w,$h );
			//z.globalCompositeOperation = 'lighter';

			circles.map(function(elem,i){
				elem.step();
				if( elem.alpha<=0 ){
					circles.splice(i,1);
				}
			});
			$tick++;
		}
		
		setInterval(render,10);

		mycanvas.addEventListener("mousedown",function(e){
			circles.push( new Circle( e.offsetX,e.offsetY ) );
		});
			
	};
		

	</script>
</head>


<body>

	<canvas id="mycanvas" width="1000px" height="600px">

	</canvas>


</body>

</html>
